import{r as P,R as nt}from"./index-G7KIa08V.js";var S={BASE_URL:"./",MODE:"production",DEV:!1,PROD:!0,SSR:!1};let ot=0;function J(t,n){const u=`atom${++ot}`,h={toString:()=>u};return typeof t=="function"?h.read=t:(h.init=t,h.read=function(w){return w(this)},h.write=function(w,l,p){return l(this,typeof p=="function"?p(w(this)):p)}),n&&(h.write=n),h}const D=t=>"init"in t,L=t=>!!t.write,N=new WeakMap,rt=(t,n)=>{N.set(t,n),t.catch(()=>{}).finally(()=>N.delete(t))},x=(t,n)=>{const u=N.get(t);u&&(N.delete(t),u(n))},Y=(t,n)=>{t.status="fulfilled",t.value=n},G=(t,n)=>{t.status="rejected",t.reason=n},st=t=>typeof(t==null?void 0:t.then)=="function",O=(t,n)=>!!t&&"v"in t&&"v"in n&&Object.is(t.v,n.v),H=(t,n)=>!!t&&"e"in t&&"e"in n&&Object.is(t.e,n.e),M=t=>!!t&&"v"in t&&t.v instanceof Promise,it=(t,n)=>"v"in t&&"v"in n&&t.v.orig&&t.v.orig===n.v.orig,T=t=>{if("e"in t)throw t.e;return t.v},ct=()=>{const t=new WeakMap,n=new WeakMap,u=new Map;let h,w;(S?"production":void 0)!=="production"&&(h=new Set,w=new Set);const l=e=>t.get(e),p=(e,r)=>{(S?"production":void 0)!=="production"&&Object.freeze(r);const i=t.get(e);if(t.set(e,r),u.has(e)||u.set(e,i),M(i)){const o="v"in r?r.v instanceof Promise?r.v:Promise.resolve(r.v):Promise.reject(r.e);i.v!==o&&x(i.v,o)}},v=(e,r,i)=>{const o=new Map;let c=!1;i.forEach((f,s)=>{!f&&s===e&&(f=r),f?(o.set(s,f),r.d.get(s)!==f&&(c=!0)):(S?"production":void 0)!=="production"&&console.warn("[Bug] atom state not found")}),(c||r.d.size!==o.size)&&(r.d=o)},_=(e,r,i)=>{const o=l(e),c={d:(o==null?void 0:o.d)||new Map,v:r};if(i&&v(e,c,i),O(o,c)&&o.d===c.d)return o;if(M(o)&&M(c)&&it(o,c)){if(o.d===c.d)return o;c.v=o.v}return p(e,c),c},E=(e,r,i,o)=>{if(st(r)){let c;const f=()=>{const d=l(e);if(!M(d)||d.v!==s)return;const A=_(e,s,i);n.has(e)&&d.d!==A.d&&F(e,A,d.d)},s=new Promise((d,A)=>{let a=!1;r.then(g=>{a||(a=!0,Y(s,g),d(g),f())},g=>{a||(a=!0,G(s,g),A(g),f())}),c=g=>{a||(a=!0,g.then(b=>Y(s,b),b=>G(s,b)),d(g))}});return s.orig=r,s.status="pending",rt(s,d=>{d&&c(d),o==null||o()}),_(e,s,i)}return _(e,r,i)},m=(e,r,i)=>{const o=l(e),c={d:(o==null?void 0:o.d)||new Map,e:r};return i&&v(e,c,i),H(o,c)&&o.d===c.d?o:(p(e,c),c)},y=(e,r)=>{const i=l(e);if(!r&&i&&(n.has(e)||Array.from(i.d).every(([a,g])=>{if(a===e)return!0;const b=y(a);return b===g||O(b,g)})))return i;const o=new Map;let c=!0;const f=a=>{if(a===e){const b=l(a);if(b)return o.set(a,b),T(b);if(D(a))return o.set(a,void 0),a.init;throw new Error("no atom init")}const g=y(a);return o.set(a,g),T(g)};let s,d;const A={get signal(){return s||(s=new AbortController),s.signal},get setSelf(){return(S?"production":void 0)!=="production"&&!L(e)&&console.warn("setSelf function cannot be used with read-only atom"),!d&&L(e)&&(d=(...a)=>{if((S?"production":void 0)!=="production"&&c&&console.warn("setSelf function cannot be called in sync"),!c)return I(e,...a)}),d}};try{const a=e.read(f,A);return E(e,a,o,()=>s==null?void 0:s.abort())}catch(a){return m(e,a,o)}finally{c=!1}},W=e=>T(y(e)),Q=e=>{let r=n.get(e);return r||(r=j(e)),r},C=(e,r)=>!r.l.size&&(!r.t.size||r.t.size===1&&r.t.has(e)),tt=e=>{const r=n.get(e);r&&C(e,r)&&V(e)},z=e=>{const r=new Map,i=new WeakMap,o=s=>{var d;const A=new Set((d=n.get(s))==null?void 0:d.t);return u.forEach((a,g)=>{var b;(b=l(g))!=null&&b.d.has(s)&&A.add(g)}),A},c=s=>{o(s).forEach(d=>{d!==s&&(r.set(d,(r.get(d)||new Set).add(s)),i.set(d,(i.get(d)||0)+1),c(d))})};c(e);const f=s=>{o(s).forEach(d=>{var A;if(d!==s){let a=i.get(d);if(a&&i.set(d,--a),!a){let g=!!((A=r.get(d))!=null&&A.size);if(g){const b=l(d),et=y(d,!0);g=!O(b,et)}g||r.forEach(b=>b.delete(d))}f(d)}})};f(e)},$=(e,...r)=>{let i=!0;const o=s=>T(y(s)),c=(s,...d)=>{let A;if(s===e){if(!D(s))throw new Error("atom not writable");const a=l(s),g=E(s,d[0]);O(a,g)||z(s)}else A=$(s,...d);if(!i){const a=R();(S?"production":void 0)!=="production"&&h.forEach(g=>g({type:"async-write",flushed:a}))}return A},f=e.write(o,c,...r);return i=!1,f},I=(e,...r)=>{const i=$(e,...r),o=R();return(S?"production":void 0)!=="production"&&h.forEach(c=>c({type:"write",flushed:o})),i},j=(e,r,i)=>{var o;const c=i||[];(o=l(e))==null||o.d.forEach((s,d)=>{const A=n.get(d);A?A.t.add(e):d!==e&&j(d,e,c)}),y(e);const f={t:new Set(r&&[r]),l:new Set};if(n.set(e,f),(S?"production":void 0)!=="production"&&w.add(e),L(e)&&e.onMount){const{onMount:s}=e;c.push(()=>{const d=s((...A)=>I(e,...A));d&&(f.u=d)})}return i||c.forEach(s=>s()),f},V=e=>{var r;const i=(r=n.get(e))==null?void 0:r.u;i&&i(),n.delete(e),(S?"production":void 0)!=="production"&&w.delete(e);const o=l(e);o?(M(o)&&x(o.v),o.d.forEach((c,f)=>{if(f!==e){const s=n.get(f);s&&(s.t.delete(e),C(f,s)&&V(f))}})):(S?"production":void 0)!=="production"&&console.warn("[Bug] could not find atom state to unmount",e)},F=(e,r,i)=>{const o=new Set(r.d.keys());i==null||i.forEach((c,f)=>{if(o.has(f)){o.delete(f);return}const s=n.get(f);s&&(s.t.delete(e),C(f,s)&&V(f))}),o.forEach(c=>{const f=n.get(c);f?f.t.add(e):n.has(e)&&j(c,e)})},R=()=>{let e;for((S?"production":void 0)!=="production"&&(e=new Set);u.size;){const r=Array.from(u);u.clear(),r.forEach(([i,o])=>{const c=l(i);if(c){const f=n.get(i);f&&c.d!==(o==null?void 0:o.d)&&F(i,c,o==null?void 0:o.d),f&&!(!M(o)&&(O(o,c)||H(o,c)))&&(f.l.forEach(s=>s()),(S?"production":void 0)!=="production"&&e.add(i))}else(S?"production":void 0)!=="production"&&console.warn("[Bug] no atom state to flush")})}if((S?"production":void 0)!=="production")return e},q=(e,r)=>{const i=Q(e),o=R(),c=i.l;return c.add(r),(S?"production":void 0)!=="production"&&h.forEach(f=>f({type:"sub",flushed:o})),()=>{c.delete(r),tt(e),(S?"production":void 0)!=="production"&&h.forEach(f=>f({type:"unsub"}))}};return(S?"production":void 0)!=="production"?{get:W,set:I,sub:q,dev_subscribe_store:(e,r)=>{if(r!==2)throw new Error("The current StoreListener revision is 2.");return h.add(e),()=>{h.delete(e)}},dev_get_mounted_atoms:()=>w.values(),dev_get_atom_state:e=>t.get(e),dev_get_mounted:e=>n.get(e),dev_restore_atoms:e=>{for(const[i,o]of e)D(i)&&(E(i,o),z(i));const r=R();h.forEach(i=>i({type:"restore",flushed:r}))}}:{get:W,set:I,sub:q}};let B;(S?"production":void 0)!=="production"&&(typeof globalThis.__NUMBER_OF_JOTAI_INSTANCES__=="number"?++globalThis.__NUMBER_OF_JOTAI_INSTANCES__:globalThis.__NUMBER_OF_JOTAI_INSTANCES__=1);const K=()=>(B||((S?"production":void 0)!=="production"&&globalThis.__NUMBER_OF_JOTAI_INSTANCES__!==1&&console.warn("Detected multiple Jotai instances. It may cause unexpected behavior with the default store. https://github.com/pmndrs/jotai/discussions/2044"),B=ct()),B);var ut={BASE_URL:"./",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const dt=P.createContext(void 0),X=t=>{const n=P.useContext(dt);return(t==null?void 0:t.store)||n||K()},ft=t=>typeof(t==null?void 0:t.then)=="function",lt=nt.use||(t=>{if(t.status==="pending")throw t;if(t.status==="fulfilled")return t.value;throw t.status==="rejected"?t.reason:(t.status="pending",t.then(n=>{t.status="fulfilled",t.value=n},n=>{t.status="rejected",t.reason=n}),t)});function at(t,n){const u=X(n),[[h,w,l],p]=P.useReducer(E=>{const m=u.get(t);return Object.is(E[0],m)&&E[1]===u&&E[2]===t?E:[m,u,t]},void 0,()=>[u.get(t),u,t]);let v=h;(w!==u||l!==t)&&(p(),v=u.get(t));const _=n==null?void 0:n.delay;return P.useEffect(()=>{const E=u.sub(t,()=>{if(typeof _=="number"){setTimeout(p,_);return}p()});return p(),E},[u,t,_]),P.useDebugValue(v),ft(v)?lt(v):v}function vt(t,n){const u=X(n);return P.useCallback((...w)=>{if((ut?"production":void 0)!=="production"&&!("write"in t))throw new Error("not writable atom");return u.set(t,...w)},[u,t])}function bt(t,n){return[at(t,n),vt(t,n)]}var Z={BASE_URL:"./",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const ht=Symbol((Z?"production":void 0)!=="production"?"RESET":""),U=(t,n,u)=>(n.has(u)?n:n.set(u,t())).get(u),wt=new WeakMap,_t=(t,n,u,h)=>{const w=U(()=>new WeakMap,wt,n),l=U(()=>new WeakMap,w,u);return U(t,l,h)};function mt(t,n,u=Object.is){return _t(()=>{const h=Symbol(),w=([p,v])=>{if(v===h)return n(p);const _=n(p,v);return u(v,_)?v:_},l=J(p=>{const v=p(l),_=p(t);return _ instanceof Promise||v instanceof Promise?Promise.all([_,v]).then(w):w([_,v])});return l.init=h,l},t,n,u)}const pt=t=>typeof(t==null?void 0:t.then)=="function";function gt(t){let n,u;const h={getItem:(w,l)=>{var p,v;const _=m=>{if(m=m||"",n!==m){try{u=JSON.parse(m)}catch{return l}n=m}return u},E=(v=(p=t())==null?void 0:p.getItem(w))!=null?v:null;return pt(E)?E.then(_):_(E)},setItem:(w,l)=>{var p;return(p=t())==null?void 0:p.setItem(w,JSON.stringify(l))},removeItem:w=>{var l;return(l=t())==null?void 0:l.removeItem(w)}};return typeof window<"u"&&typeof window.addEventListener=="function"&&window.Storage&&(h.subscribe=(w,l,p)=>{if(!(t()instanceof window.Storage))return()=>{};const v=_=>{if(_.storageArea===t()&&_.key===w){let E;try{E=JSON.parse(_.newValue||"")}catch{E=p}l(E)}};return window.addEventListener("storage",v),()=>{window.removeEventListener("storage",v)}}),h}const Et=gt(()=>typeof window<"u"?window.localStorage:void 0);function yt(t,n,u=Et,h){const w=h==null?void 0:h.getOnInit,l=J(w?u.getItem(t,n):n);return(Z?"production":void 0)!=="production"&&(l.debugPrivate=!0),l.onMount=v=>{w||v(u.getItem(t,n));let _;return u.subscribe&&(_=u.subscribe(t,v,n)),_},J(v=>v(l),(v,_,E)=>{const m=typeof E=="function"?E(v(l)):E;return m===ht?(_(l,n),u.removeItem(t)):m instanceof Promise?m.then(y=>(_(l,y),u.setItem(t,y))):(_(l,m),u.setItem(t,m))})}let k,At=()=>{if(k)return k;let t=K();return k=t,t};const Mt=At();export{J as a,vt as b,yt as c,X as d,bt as e,Mt as j,At as o,mt as s,at as u};
